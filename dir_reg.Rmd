---
title: "dir_reg"
author: "Hanming (Albert) Yang"
date: "12/2/2023"
output: html_document
---

```{r setup, include=FALSE}
# install.packages("DirichletReg")
# install.packages("Formula")


```


```{r cars}
library(DirichletReg)
```


You can also embed plots, for example:

```{r pressure, echo=FALSE}
# Read the topic distributions
topic_dist <- read.csv("topic_distributions.csv")

# Read the combined data
combined_data <- read.csv("combined_data.csv")

# If necessary, merge the two data frames based on the state column
# (Assuming 'state' is a common column in both data frames)
# data_for_regression <- merge(combined_data, topic_dist, by = "state")
```

```{r pressure, echo=FALSE}
topic_dist
```

```{r pressure, echo=FALSE}
# Standardize all columns except the first one (assuming it's an ID or non-numeric)
combined_data[, -1] <- scale(combined_data[, -1])

combined_data

```


```{r pressure, echo=FALSE}
data_for_regression <- merge(combined_data, topic_dist, by = "state")
data_for_regression
# Prepare the data for Dirichlet regression
# Assuming the topic columns are named Topic1, Topic2, ..., TopicN
topics <- as.matrix(data_for_regression[, c("top_0", "top_1", "top_2", "top_3")])

dirich_data <- DR_data(topics)


```

```{r pressure, echo=FALSE}

# Define the model (replace `independent_vars` with actual names of your independent variables)

fit <- DirichReg(dirich_data ~ gdp + Hispanic.or.Latino + White.alone + Black.or.African.American.alone, data = data_for_regression)
# fit <- DirichReg(dirich_data ~ Hispanic.or.Latino + White.alone + Black.or.African.American.alone, data = data_for_regression)
#fit <- DirichReg(dirich_data ~ White.alone, data = data_for_regression)

# fit <- DirichReg(dirich_data ~ independent_var1 + independent_var2, data = data_for_regression)
# Fit the model
#fit <- DirichReg(model)

# View the summary
# fit <- DirichReg(dirich_data ~ White.alone, data = data_for_regression)
summary(fit)

```
